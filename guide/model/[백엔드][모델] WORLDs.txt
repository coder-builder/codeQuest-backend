================================================================================
                           World ëª¨ë¸ ì™„ì „ ì •ë¦¬
================================================================================

ì‘ì„±ì¼: 2025-11-06
íŒŒì¼: worlds/models.py


================================================================================
ğŸ“¦ ëª¨ë¸ ê°œìš”
================================================================================

[ëª©ì ]
ì½”ë”© ì–¸ì–´ë³„ ì›”ë“œ (ì˜ˆ: Python, Java, JavaScript)
ì‚¬ìš©ìê°€ í•™ìŠµí•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ëŒ€í‘œí•˜ëŠ” ìµœìƒìœ„ ë‹¨ìœ„

[ìœ„ì¹˜]
Django App: worlds
íŒŒì¼: worlds/models.py
í…Œì´ë¸”ëª…: worlds_world


================================================================================
ğŸ—‚ï¸ í•„ë“œ êµ¬ì¡°
================================================================================

title (CharField)
â”œâ”€ ìµœëŒ€ ê¸¸ì´: 100ì
â”œâ”€ ì„¤ëª…: ì½”ë”© ì–¸ì–´ ì›”ë“œ
â”œâ”€ ì˜ˆì‹œ: "Python", "Java", "JavaScript"
â””â”€ Help text: "ì˜ˆ: Python, Java, Javascript"

description (TextField)
â”œâ”€ ì„¤ëª…: ì›”ë“œ ì„¤ëª…
â”œâ”€ ì˜ˆì‹œ: "Pythonì€ ì´ˆë³´ìì—ê²Œ ê°€ì¥ ì¹œí™”ì ì¸ ì–¸ì–´ì…ë‹ˆë‹¤"
â””â”€ í•„ìˆ˜ ì…ë ¥

icon (CharField)
â”œâ”€ ìµœëŒ€ ê¸¸ì´: 50ì
â”œâ”€ ì„¤ëª…: ì•„ì´ì½˜
â”œâ”€ ì˜ˆì‹œ: "ğŸ", "â˜•", "ğŸ’›"
â””â”€ Help text: "ì´ëª¨ì§€"

is_locked (BooleanField)
â”œâ”€ ê¸°ë³¸ê°’: True
â”œâ”€ ì„¤ëª…: ê¸°ë³¸ ì ê¸ˆ ì—¬ë¶€
â””â”€ ìš©ë„: ì‹ ê·œ ì›”ë“œ ì¶œì‹œ ì‹œ ì´ˆê¸° ì ê¸ˆ ìƒíƒœ

created_at (DateTimeField)
â”œâ”€ ìë™ ìƒì„±: auto_now_add=True
â”œâ”€ ì„¤ëª…: ìƒì„±ì¼
â””â”€ ìˆ˜ì • ë¶ˆê°€

updated_at (DateTimeField)
â”œâ”€ ìë™ ì—…ë°ì´íŠ¸: auto_now=True
â”œâ”€ ì„¤ëª…: ìˆ˜ì •ì¼
â””â”€ ìë™ ê°±ì‹ 


================================================================================
âš™ï¸ Meta ì„¤ì •
================================================================================

ordering = ['title']
â”œâ”€ ì •ë ¬ ê¸°ì¤€: ì œëª© ì•ŒíŒŒë²³ ìˆœ
â””â”€ ì˜ˆì‹œ: Java â†’ JavaScript â†’ Python

verbose_name = "ì½”ë”© ì–¸ì–´"
verbose_name_plural = "ì½”ë”© ì–¸ì–´ ëª©ë¡"
â””â”€ Django Admin í‘œì‹œëª…


================================================================================
ğŸ”— ê´€ê³„ (Relationships)
================================================================================

[1:N ê´€ê³„ - Reverse Relations]

world.stages
â”œâ”€ related_name: stages
â”œâ”€ ì ‘ê·¼: world.stages.all()
â”œâ”€ ì„¤ëª…: ì´ ì›”ë“œì— ì†í•œ ëª¨ë“  ìŠ¤í…Œì´ì§€
â””â”€ ì˜ˆì‹œ:
    python = World.objects.get(title='Python')
    stages = python.stages.all()  # Pythonì˜ ëª¨ë“  ìŠ¤í…Œì´ì§€

world.user_progresses
â”œâ”€ related_name: user_progresses
â”œâ”€ ì ‘ê·¼: world.user_progresses.all()
â”œâ”€ ì„¤ëª…: ì´ ì›”ë“œë¥¼ í•™ìŠµ ì¤‘ì¸ ëª¨ë“  ì‚¬ìš©ìì˜ ì§„í–‰ ìƒí™©
â””â”€ ì˜ˆì‹œ:
    python = World.objects.get(title='Python')
    users = python.user_progresses.all()  # Python í•™ìŠµ ì¤‘ì¸ ì‚¬ìš©ìë“¤


================================================================================
ğŸ“Š ë©”ì„œë“œ ë° í”„ë¡œí¼í‹°
================================================================================

[__str__()]
ë°˜í™˜ê°’: f"{self.title} {self.icon}"
ì˜ˆì‹œ: "Python ğŸ", "Java â˜•"

[ì»¤ìŠ¤í…€ ë©”ì„œë“œ]
âŒ ì—†ìŒ
â””â”€ WorldëŠ” ë‹¨ìˆœ ë°ì´í„° ëª¨ë¸ë¡œ íŠ¹ë³„í•œ ë¡œì§ ì—†ìŒ


================================================================================
ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°
================================================================================

CREATE TABLE worlds_world (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    description TEXT NOT NULL,
    icon VARCHAR(50) NOT NULL,
    is_locked TINYINT(1) NOT NULL DEFAULT 1,
    created_at DATETIME(6) NOT NULL,
    updated_at DATETIME(6) NOT NULL
);


================================================================================
ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ
================================================================================

[1. World ìƒì„±]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python_world = World.objects.create(
    title='Python',
    description='ì´ˆë³´ìì—ê²Œ ê°€ì¥ ì¹œí™”ì ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´',
    icon='ğŸ',
    is_locked=False
)


[2. World ì¡°íšŒ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë‹¨ì¼ ì¡°íšŒ
python = World.objects.get(title='Python')

# ì „ì²´ ì¡°íšŒ (ì•ŒíŒŒë²³ ìˆœ)
all_worlds = World.objects.all()

# ì ê¸ˆ í•´ì œëœ ì›”ë“œë§Œ
unlocked_worlds = World.objects.filter(is_locked=False)


[3. ê´€ë ¨ ë°ì´í„° ì¡°íšŒ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python = World.objects.get(title='Python')

# ìŠ¤í…Œì´ì§€ ê°œìˆ˜
stage_count = python.stages.count()

# ëª¨ë“  ìŠ¤í…Œì´ì§€
stages = python.stages.all()

# ì²« ë²ˆì§¸ ìŠ¤í…Œì´ì§€
first_stage = python.stages.first()

# íŠ¹ì • ìˆœì„œ ìŠ¤í…Œì´ì§€
stage_2 = python.stages.get(order=2)

# í•™ìŠµ ì¤‘ì¸ ì‚¬ìš©ì ìˆ˜
user_count = python.user_progresses.count()


[4. World ìˆ˜ì •]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python = World.objects.get(title='Python')
python.description = 'ìƒˆë¡œìš´ ì„¤ëª…'
python.save()


[5. World ì‚­ì œ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
python = World.objects.get(title='Python')
python.delete()  # ê´€ë ¨ Stage, UserWorld ë“±ë„ CASCADE ì‚­ì œ


================================================================================
ğŸ” Django Admin ì„¤ì • ì˜ˆì‹œ
================================================================================

# worlds/admin.py

from django.contrib import admin
from .models import World

@admin.register(World)
class WorldAdmin(admin.ModelAdmin):
    list_display = ['id', 'title', 'icon', 'is_locked', 'created_at']
    list_filter = ['is_locked', 'created_at']
    search_fields = ['title', 'description']
    ordering = ['title']
    
    fieldsets = (
        ('ê¸°ë³¸ ì •ë³´', {
            'fields': ('title', 'icon', 'description')
        }),
        ('ì„¤ì •', {
            'fields': ('is_locked',)
        }),
        ('ì‹œê°„ ì •ë³´', {
            'fields': ('created_at', 'updated_at'),
            'classes': ('collapse',)
        }),
    )
    
    readonly_fields = ('created_at', 'updated_at')


================================================================================
ğŸŒ API Serializer ì˜ˆì‹œ
================================================================================

# worlds/serializers.py

from rest_framework import serializers
from .models import World

class WorldSerializer(serializers.ModelSerializer):
    stage_count = serializers.SerializerMethodField()
    
    class Meta:
        model = World
        fields = [
            'id',
            'title',
            'description',
            'icon',
            'is_locked',
            'stage_count',
            'created_at',
            'updated_at'
        ]
        read_only_fields = ['created_at', 'updated_at']
    
    def get_stage_count(self, obj):
        """ìŠ¤í…Œì´ì§€ ê°œìˆ˜"""
        return obj.stages.count()


[API ì‘ë‹µ ì˜ˆì‹œ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
    "id": 1,
    "title": "Python",
    "description": "ì´ˆë³´ìì—ê²Œ ê°€ì¥ ì¹œí™”ì ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´",
    "icon": "ğŸ",
    "is_locked": false,
    "stage_count": 5,
    "created_at": "2025-11-04T10:00:00Z",
    "updated_at": "2025-11-04T10:00:00Z"
}


================================================================================
ğŸ® ì‹¤ì „ í™œìš© ì‹œë‚˜ë¦¬ì˜¤
================================================================================

[ì‹œë‚˜ë¦¬ì˜¤ 1: ì›”ë“œ ëª©ë¡ API]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# views.py
from rest_framework.decorators import api_view
from rest_framework.response import Response
from .models import World
from .serializers import WorldSerializer

@api_view(['GET'])
def world_list(request):
    """ì ê¸ˆ í•´ì œëœ ì›”ë“œ ëª©ë¡"""
    worlds = World.objects.filter(is_locked=False)
    serializer = WorldSerializer(worlds, many=True)
    return Response(serializer.data)


[ì‹œë‚˜ë¦¬ì˜¤ 2: ì›”ë“œ ìƒì„¸ + ìŠ¤í…Œì´ì§€ ëª©ë¡]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
@api_view(['GET'])
def world_detail(request, world_id):
    """ì›”ë“œ ìƒì„¸ ì •ë³´ + ìŠ¤í…Œì´ì§€ ëª©ë¡"""
    world = World.objects.get(id=world_id)
    stages = world.stages.all()
    
    return Response({
        'world': WorldSerializer(world).data,
        'stages': StageSerializer(stages, many=True).data
    })


[ì‹œë‚˜ë¦¬ì˜¤ 3: ì‚¬ìš©ìë³„ ì›”ë“œ ì§„í–‰ ìƒí™©]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
@api_view(['GET'])
def my_worlds(request):
    """ë‚´ê°€ í•™ìŠµ ì¤‘ì¸ ì›”ë“œ"""
    user_worlds = UserWorld.objects.filter(
        user=request.user,
        is_unlocked=True
    ).select_related('world')
    
    result = []
    for uw in user_worlds:
        result.append({
            'world': WorldSerializer(uw.world).data,
            'progress': uw.progress_percentage,
            'last_studied': uw.last_studied_at
        })
    
    return Response(result)


================================================================================
âš ï¸ ì£¼ì˜ì‚¬í•­
================================================================================

[1. CASCADE ì‚­ì œ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
World ì‚­ì œ ì‹œ ê´€ë ¨ëœ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤:
âœ— Stage (ìŠ¤í…Œì´ì§€)
âœ— Lesson (ë ˆìŠ¨)  
âœ— Problem (ë¬¸ì œ)
âœ— UserWorld (ì‚¬ìš©ì ì§„í–‰ ìƒí™©)
âœ— UserStageProgress
âœ— UserLessonProgress
âœ— ProblemAttempt

â†’ ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” is_locked=Trueë¡œ ë¹„í™œì„±í™” ê¶Œì¥


[2. ì ê¸ˆ ì²˜ë¦¬]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
World.is_locked vs UserWorld.is_unlocked

World.is_locked (ì „ì—­):
- ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ì ìš©
- ì‹ ê·œ ì›”ë“œ ì¶œì‹œ ì œì–´ìš©

UserWorld.is_unlocked (ê°œì¸):  
- ì‚¬ìš©ìë³„ ì ê¸ˆ í•´ì œ ìƒíƒœ
- ê°œì¸ í•™ìŠµ ì§„í–‰ì— ë”°ë¼ ë³€ê²½


[3. ì„±ëŠ¥ ìµœì í™”]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âŒ N+1 ì¿¼ë¦¬ ë°œìƒ
worlds = World.objects.all()
for world in worlds:
    print(world.stages.count())  # ê° ì›”ë“œë§ˆë‹¤ ì¿¼ë¦¬ 1íšŒ

# âœ… prefetch_related ì‚¬ìš©
worlds = World.objects.prefetch_related('stages').all()
for world in worlds:
    print(world.stages.count())  # ì´ ì¿¼ë¦¬ 2íšŒ


================================================================================
ğŸ“ ë°ì´í„° ì˜ˆì‹œ
================================================================================

[ì›”ë“œ ë°ì´í„° ìƒ˜í”Œ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Python ğŸ
   - ì´ˆë³´ìì—ê²Œ ê°€ì¥ ì¹œí™”ì ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´
   - ìŠ¤í…Œì´ì§€: 15ê°œ
   - ì ê¸ˆ: í•´ì œ

2. Java â˜•
   - ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ê°ì²´ì§€í–¥ ì–¸ì–´
   - ìŠ¤í…Œì´ì§€: 20ê°œ
   - ì ê¸ˆ: í•´ì œ

3. JavaScript ğŸ’›
   - ì›¹ ê°œë°œì˜ í•„ìˆ˜ ì–¸ì–´
   - ìŠ¤í…Œì´ì§€: 18ê°œ
   - ì ê¸ˆ: í•´ì œ

4. C++ âš¡
   - ê³ ì„±ëŠ¥ ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë°
   - ìŠ¤í…Œì´ì§€: 25ê°œ
   - ì ê¸ˆ: ì ê¹€ (ì¤€ë¹„ ì¤‘)


================================================================================
ğŸ”— ê´€ë ¨ ëª¨ë¸ ë§í¬
================================================================================

â†’ UserWorld: ì‚¬ìš©ìë³„ ì›”ë“œ ì§„í–‰ ìƒí™©
â†’ Stage: ì›”ë“œ ë‚´ ìŠ¤í…Œì´ì§€
â†’ Lesson: ìŠ¤í…Œì´ì§€ ë‚´ ë ˆìŠ¨
â†’ Problem: ë ˆìŠ¨ ë‚´ ë¬¸ì œ


================================================================================
ë!
================================================================================
